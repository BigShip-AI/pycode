{% extends 'base/base.html' %}
{% block title %}
    社团活动列表
{% endblock %}
{% block body %}
    <body>
    <div class="x-body">
        <xblock>
            <button class="layui-btn layui-btn-danger" onclick="delAll()"><i class="layui-icon"></i>批量删除</button>
            <span class="x-right" style="line-height:40px">
                <a href="javascript:location.reload()" style="margin-right: 20px;">
                <button class="layui-btn layui-btn-normal" style="padding: 0 15px;">
                    <i class="layui-icon" style="font-size: 25px;font-weight: bolder;">&#xe669;</i>
                </button>
            </a>
                共有数据：
                {% for data in data_list %}{% if loop.last %}{{ loop.index }}{% endif %}{% endfor %}条</span>
        </xblock>
        <table class="layui-table x-admin">
            <thead>
            <tr>
                <th>
                    <div class="layui-unselect header layui-form-checkbox" lay-skin="primary"><i class="layui-icon">&#xe605;</i>
                    </div>
                </th>
                <th>序号</th>
                <th>社团名称</th>
                <th>活动标题</th>
                <th>活动地点</th>
                <th>活动负责人</th>
                <th>活动时间</th>
                <th>操作</th>
            </tr>
            </thead>
            <tbody>
            {% for data in data_list %}
                <tr>
                    <td>
                        <div class="layui-unselect layui-form-checkbox" lay-skin="primary" data-id='{{ data.id }}'>
                            <i class="layui-icon">&#xe605;</i>
                        </div>
                    </td>
                    <td>{{ loop.index }}</td>
                    <td>{{ data.massModel.massName or '社团不存在' }}</td>
                    <td>{{ data.activity_title }}</td>
                    <td>{{ data.activity_address }}</td>
                    <td>{{ data.activity_principal }}</td>
                    <td>{{ data.activity_date }}</td>
                    <td class="td-manage" style="width: 130px;">
                        <button class="layui-btn layui-btn-sm layui-btn-radius" title="编辑"
                                onclick="x_admin_show('编辑','{{ url_for('cms_bp.activity_edit') }}?uid={{ data.id }}')"
                                href="javascript:;">
                            <i class="layui-icon">编辑</i>
                        </button>
                        <button title="删除" onclick="clubs_del(this,'{{ data.id }}')" href="javascript:;"
                                class="layui-btn layui-btn-sm layui-btn-radius layui-btn-danger">
                            <i class="layui-icon">删除</i>
                        </button>
                    </td>
                </tr>
            {% endfor %}
            </tbody>
        </table>

    </div>

    <script>
        layui.use('laydate', function () {
            var laydate = layui.laydate;
            //执行一个laydate实例
            laydate.render({
                elem: '#start' //指定元素
            });
            //执行一个laydate实例
            laydate.render({
                elem: '#end' //指定元素
            });
        });

        /*用户-删除*/
        function clubs_del(obj, id) {
            layer.confirm('确认要删除吗？', function (index) {
                //发异步删除数据
                $.ajax({
                    type: "DELETE",
                    data: {"uid": id},
                    dataType: "json",
                    success: function (data) {
                        if (data.status === 0) {
                            $(obj).parents("tr").remove();
                            layer.msg('删除成功!', {icon: 1, time: 1000});
                            window.location.reload();
                        } else {
                            layer.msg('删除失败!', {icon: 2, time: 1000});
                        }
                    }
                });
            });
        }
    </script>

    </body>
{% endblock %}
{% block footer_js %}
    <script type="text/javascript" src="{{ url_for('static',filename='./js/deletes.js') }}"></script>
{% endblock %}